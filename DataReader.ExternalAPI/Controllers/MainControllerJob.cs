using CSharpFunctionalExtensions;
using Quartz;

using DataReader.Core.Abstractions.Services.Handlers;
using DataReader.Core.Contracts.Params;


namespace DataReader.ExternalAPI.Controllers
{
  public class MainControllerJob : IJob
  {
    private readonly IHandlerService<Task<Result>, List<UsersDTOParam>> _userHandler;

    public MainControllerJob(IHandlerService<Task<Result>, List<UsersDTOParam>> userHandler)
    {
      _userHandler = userHandler;
    }

    public async Task Execute(IJobExecutionContext context)
    {
      //string empty_json = "{\r\n  \"@odata.context\": \"https://analytics.dev.azure.com/KAPPASTAR-IT/_odata/v3.0/$metadata#WorkItems(WorkItemId,InProgressDate,CompletedDate,InProgressDateSK,CompletedDateSK,AnalyticsUpdatedDate,ProjectSK,WorkItemRevisionSK,AreaSK,IterationSK,AssignedToUserSK,ChangedByUserSK,CreatedByUserSK,ActivatedByUserSK,ClosedByUserSK,ResolvedByUserSK,ActivatedDateSK,ChangedDateSK,ClosedDateSK,CreatedDateSK,ResolvedDateSK,StateChangeDateSK,WorkItemType,ChangedDate,CreatedDate,State,ActivatedDate,ClosedDate,Priority,ResolvedDate,CompletedWork,Effort,FinishDate,OriginalEstimate,RemainingWork,StartDate,StoryPoints,TargetDate,ParentWorkItemId,TagNames,StateChangeDate,Custom_719f69f1__002Df7d0__002D4baa__002Db6ce__002De77ad5dfcdf3,Custom_Company,Custom_Eksternareferenca,Custom_ITServiceorApplication,Custom_Statusprojekta,Custom_TicketNo)\",\r\n  \"vsts.warnings@odata.type\": \"#Collection(String)\",\r\n  \"@vsts.warnings\": [\r\n    \"VS403509: The specified query exceeds the recommended size of 10 columns. Details on recommended query patterns are available here: https://go.microsoft.com/fwlink/?linkid=861060.\"\r\n  ],\r\n  \"value\": []\r\n}";
      string json = "{\r\n  \"@odata.context\": \"https://analytics.dev.azure.com/KAPPASTAR-IT/_odata/v3.0/$metadata#Users(*)\",\r\n  \"value\": [\r\n    {\r\n      \"UserSK\": \"e2eee4d9-03ac-42d3-ab71-14c6546ad677\",\r\n      \"UserId\": \"c0998ac9-6643-6387-8dd1-4bc726d4ae28\",\r\n      \"UserName\": \"Zeljko Toplak\",\r\n      \"UserEmail\": \"zeljko.toplak@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-09-01T09:00:29.4133333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"a3d8fe14-1600-4c97-bcf0-25050b816b62\",\r\n      \"UserId\": \"ad4d82f7-6eb0-696c-97f9-7e607b2b1af0\",\r\n      \"UserName\": \"Milorad Grkovic\",\r\n      \"UserEmail\": \"milorad.grkovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-19T08:46:02.1033333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"585a7040-443d-402c-944c-2f67de6d5acf\",\r\n      \"UserId\": \"8634064b-8cac-6b35-95f2-1bfcc010cfe7\",\r\n      \"UserName\": \"Vasja Bojanic\",\r\n      \"UserEmail\": \"vasja@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-12T09:18:26.6833333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"ba222308-1d9c-4597-b6e0-2fb3ee34dcbf\",\r\n      \"UserId\": \"3b5b930d-7612-6249-9ce9-e5d79d69b55f\",\r\n      \"UserName\": \"Dejan Pavlovic\",\r\n      \"UserEmail\": \"dejan.pavlovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-03T13:47:23.2266667Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"c91dc912-ae5e-4dbc-bc40-4461f5819cfd\",\r\n      \"UserId\": \"ee664108-e13d-4dd8-8e5e-961cbc1a170f\",\r\n      \"UserName\": \"marko.cupac@kappastar.com\",\r\n      \"UserEmail\": \"marko.cupac@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-04T05:36:45.47Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"13c76e55-07f4-4e0c-b0aa-45193740166d\",\r\n      \"UserId\": \"c08fb906-3a57-680f-b463-b9f5b4aea2e1\",\r\n      \"UserName\": \"Milos Markovic\",\r\n      \"UserEmail\": \"milos.markovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-11T09:45:38.67Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"ec79fbed-5d3d-406c-8319-4f8e5c9c4630\",\r\n      \"UserId\": \"2481d78f-3a59-6727-a276-a0e4e0898dc3\",\r\n      \"UserName\": \"Violeta Stakic\",\r\n      \"UserEmail\": \"violeta.stakic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-13T07:18:00.5466667Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"68d63251-ab40-41fb-bb28-7ddccf96b5df\",\r\n      \"UserId\": \"a8c18bfd-fb49-6e27-9514-f0368f8f00a7\",\r\n      \"UserName\": \"Vasja Bojanic\",\r\n      \"UserEmail\": \"vasja.bojanic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-03T13:54:25.6066667Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"2c0a9ecc-2b92-44e9-bebb-8fce10ebfa0f\",\r\n      \"UserId\": \"b17552b9-e5cd-6c98-bf27-0e49152a0610\",\r\n      \"UserName\": \"Igor Petkovic\",\r\n      \"UserEmail\": \"igor.petkovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-10T09:43:42.8666667Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"e7688fc5-344e-4e11-a9ee-9e3f964bc662\",\r\n      \"UserId\": \"759b25a2-7644-6e0b-8097-1c0e0344ccbf\",\r\n      \"UserName\": \"Dusan Antic\",\r\n      \"UserEmail\": \"dusan.antic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-06T12:07:21.8633333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"227cb93c-626a-445b-99ba-c8428b9a0bc3\",\r\n      \"UserId\": \"0946ec92-6856-4416-b301-36855e39f9b6\",\r\n      \"UserName\": \"Aleksandra Milutinovic\",\r\n      \"UserEmail\": \"aleksandra.milutinovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-04-24T10:09:47.6466667Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"8ddb30d2-9f36-4683-a201-c91294e50510\",\r\n      \"UserId\": \"151674e4-3cae-64f7-b631-aff83f3a0bfa\",\r\n      \"UserName\": \"Dejan Milutinovic\",\r\n      \"UserEmail\": \"dejan.milutinovic@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2023-11-06T11:16:23.1733333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    },\r\n    {\r\n      \"UserSK\": \"ebad373b-0392-46e1-8a91-e1261e947331\",\r\n      \"UserId\": \"730743a4-ce9d-6fb8-b969-12a4d9fe995c\",\r\n      \"UserName\": \"Vesna Braun\",\r\n      \"UserEmail\": \"vesna.braun@kappastar.com\",\r\n      \"AnalyticsUpdatedDate\": \"2024-07-23T13:13:00.2333333Z\",\r\n      \"GitHubUserId\": null,\r\n      \"UserType\": null\r\n    }\r\n  ]\r\n}";

      await _userHandler.Parsing(json);

      await Task.CompletedTask;
    }
  }
}
